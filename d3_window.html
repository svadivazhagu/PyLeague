<script src="https://d3js.org/d3.v5.min.js"></script>
<link rel="stylesheet" type="text/css" href="d3.css">.

<svg id='vis' class='svg-format'></svg>

<script>
    console.log(d3); // test if d3 is loaded

    const WIDTH = 800;
    const HEIGHT = 800;
    var svg = d3.select('body').select('#vis')
        .attr('width', WIDTH)
        .attr('height', HEIGHT)

    var scale = d3.scaleLinear()
        .domain([0, 15000])
        .range([0, 1000])

    var xScale = d3.scaleLinear()
        .domain([0, 15000])
        .range([0, WIDTH])

    var yScale = d3.scaleLinear()
        .domain([0, 15000])
        .range([HEIGHT, 0])

    // var partColor = d3.scaleLinear()
    //     .domain([1, 10])
    //     .range(['#000000', '#FF00FF'])
    var colors = d3.scaleOrdinal(d3.schemeCategory10);
    var line1 = d3.line()
        .x(d => xScale(parseFloat(d.x)))
        .y(d => yScale(parseFloat(d.y)))


    // style='background-image: url("http:\\\\ddragon.leagueoflegends.com\\cdn\\6.8.1\\img\\map\\map11.png")'
    fetch('http://localhost:8080/partFrame.csv', { 'Access-Control-Allow-Origin': '*' })
        .then(result => {
            return result.text();
        }).then(result => {
            console.log(result)
            var data = d3.csvParse(result)


            for (let i = 1; i < 11; i++) {
                let filtered = []
                for (let j = 0; j < data.length; j++) {
                    if (data[j].participantId === "" + i && data[j].x !== 'NaN')
                        filtered.push(data[j])
                }
     
                svg.append('path')
                    .datum(filtered)
                    .attr('class', 'line' + ' l' + i)
                    .attr('d', line1)
                    .attr('style', 'stroke: none; fill: none; stroke-width: 3')
            }
            var circles = svg.selectAll('positions')
                .data(data)
                .enter()
                .append('circle')
                .attr('class', d => "p" + d.participantId + " circle")
                .attr('cx', d => xScale(parseFloat(d.x)))
                .attr('cy', d => yScale(parseFloat(d.y)))
                .attr('r', 10)
                .attr('id', d => "p" + d.participantId)
                .attr('fill', d => colors(d.participantId))
                .on('mouseover', function (d) {

                    d3.selectAll('.circle')
                        .attr('fill', 'blacks')

                    d3.selectAll('.p' + d.participantId)
                        .attr('fill', d => colors(d.participantId))

                    d3.selectAll('.l' + d.participantId)
                        .attr('style', 'stroke:' + colors(d.participantId + "") + '; ' + "; fill: none; stroke-width: 3")


                }).on('mouseout', function (d) {
                    d3.selectAll('.circle')
                        .attr('fill', d => colors(d.participantId))

                        d3.selectAll('.l' + d.participantId)
                        .attr('style','stroke: none; fill: none; stroke-width: 3')
                })
        })
</script>